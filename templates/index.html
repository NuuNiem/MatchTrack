{% extends 'base.html' %}

{% block content %}
  <h2>Ottelut</h2>

  <form method="get" action="{{ url_for('items') }}">
    <label for="q">Haku</label>
    <input type="text" id="q" name="q" placeholder="Hae otsikolla tai kuvauksella" value="{{ q }}">
    <button type="submit">Hae</button>
    {% if q %}<a href="{{ url_for('items') }}">Tyhjenn√§</a>{% endif %}
  </form>

  {% if items %}
    <ul>
      {% for it in items %}
        <li>
          <strong>{{ it.title }}</strong>
          <div style="white-space: pre-wrap;">{{ it.description }}</div>
          <small>Omistaja: {{ it.owner_id }}</small>
          {% if session.get('user_id') and session.get('user_id') == it.owner_id %}
            <div>
              <a href="{{ url_for('edit_item', item_id=it.id) }}">Muokkaa</a>
              <form action="{{ url_for('delete_item', item_id=it.id) }}" method="post" style="display:inline">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <button type="submit" onclick="return confirm('Poistetaanko?')">Poista</button>
              </form>
            </div>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>Ei otteluita.</p>
  {% endif %}

{% endblock %}
